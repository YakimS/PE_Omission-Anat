in these scripts I've just copied catarinas script,
and change only such that it wont use global variables. The rest is just the same.
Hence - origial as much as possible: origAMAP